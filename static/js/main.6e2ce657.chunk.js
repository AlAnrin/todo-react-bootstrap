(this["webpackJsonpsome-react-app"]=this["webpackJsonpsome-react-app"]||[]).push([[0],{19:function(e,t,r){},24:function(e,t,r){"use strict";r.r(t);var n=r(0),o=(r(19),r(1)),a=r.n(o),i=r(15),c=r.n(i),s=r(12),d=r(10),u=r(5),l=r(6),b=r(2),h=r(8),p=r(7),g=r(9),j=r(11);function f(e){var t=Object(o.useState)(""),r=Object(j.a)(t,2),a=r[0],i=r[1];return Object(n.jsxs)("div",{className:"p-1",children:[Object(n.jsx)("h4",{className:"mt-1 ml-1",children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0444\u043e\u043d: "}),Object(n.jsxs)("div",{className:"input-group",children:[Object(n.jsx)("input",{type:"text",className:"form-control",value:a,onChange:function(e){return i(e.target.value)},"aria-describedby":"backgroundInput"}),Object(n.jsx)("div",{className:"input-group-append",children:Object(n.jsx)("button",{className:"btn btn-secondary",onClick:function(){return e.changeBackgroundToUrl(a)},type:"button",id:"button-addon2",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"})})]})]})}function m(e){return Object(n.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap"},children:e.colors.map((function(t){return Object(n.jsx)("div",{onClick:function(){return e.changeColorFunc(t.code)},className:e.currentColor.value===t.code?"active-color-card color-card":"color-card",style:{background:t.code}},t.code)}))})}var v=r(3),O=r.n(v),y=r(4),k=r(16),x=Object(k.a)("store",8,{upgrade:function(e){if(!e.objectStoreNames.contains("settings")){var t=e.createObjectStore("settings",{keyPath:"id",autoIncrement:!0});t.createIndex("name","name",{unique:!1}),t.createIndex("value","value",{unique:!1})}if(!e.objectStoreNames.contains("dirs")){var r=e.createObjectStore("dirs",{keyPath:"id",autoIncrement:!0});r.createIndex("title","title",{unique:!1}),r.createIndex("order","order",{unique:!1})}if(!e.objectStoreNames.contains("todos")){var n=e.createObjectStore("todos",{keyPath:"id",autoIncrement:!0});n.createIndex("title","title",{unique:!1}),n.createIndex("describe","describe",{unique:!1}),n.createIndex("data","data",{unique:!1}),n.createIndex("dir_id","dir_id",{unique:!1}),n.createIndex("order","order",{unique:!1})}}}),C=function(e,t){return Object(y.a)(O.a.mark((function r(){return O.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x;case 2:return r.abrupt("return",r.sent.get(e,t));case 3:case"end":return r.stop()}}),r)})))()},S=function(e){return Object(y.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x;case 2:return t.abrupt("return",t.sent.getAll(e));case 3:case"end":return t.stop()}}),t)})))()},w=function(e,t){return Object(y.a)(O.a.mark((function r(){return O.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x;case 2:return r.abrupt("return",r.sent.add(e,t));case 3:case"end":return r.stop()}}),r)})))()},N=function(e,t){return Object(y.a)(O.a.mark((function r(){return O.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x;case 2:return r.abrupt("return",r.sent.put(e,t));case 3:case"end":return r.stop()}}),r)})))()},D=function(e,t){return Object(y.a)(O.a.mark((function r(){return O.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,x;case 2:return r.abrupt("return",r.sent.delete(e,t));case 3:case"end":return r.stop()}}),r)})))()},I=function(e){return Object(y.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x;case 2:return t.abrupt("return",t.sent.clear(e));case 3:case"end":return t.stop()}}),t)})))()},B=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).table="settings",n.back_colors=[{color:"Purple",code:"rgba(162,86,165,0.82)"},{color:"Soft pink",code:"#ce87a4"},{color:"Blue",code:"#808dbf"},{color:"Cyan",code:"#84b8ad"},{color:"Green",code:"#9fc197"},{color:"Orange",code:"#d7c090"},{color:"Peach",code:"#d7ae99"},{color:"Black",code:"#000000"}],n.primary_colors=[{color:"Red",code:"#a51212"},{color:"Dark purple",code:"#5c0836"},{color:"Blue",code:"#052286"},{color:"Cyan",code:"#085e4e"},{color:"Green",code:"#1a6a09"},{color:"Orange",code:"#db9808"},{color:"Peach",code:"#ac3807"},{color:"Dark",code:"#3b3939"}],n.state={primaryColor:e.primaryColor,backgroundUrl:e.backgroundUrl,backgroundColor:e.backgroundUrl},n.clearSettings=n.clearSettings.bind(Object(b.a)(n)),n.changePrimaryColor=n.changePrimaryColor.bind(Object(b.a)(n)),n.changeBackgroundToUrl=n.changeBackgroundToUrl.bind(Object(b.a)(n)),n.changeBackgroundToColor=n.changeBackgroundToColor.bind(Object(b.a)(n)),n}return Object(l.a)(r,[{key:"clearSettings",value:function(){var e=this;I(this.table).then((function(){var t=getComputedStyle(document.body).getPropertyValue("--primary"),r={id:-1,value:""};e.props.setAndChangeSettings("backgroundUrl",Object(g.a)({},r)),e.props.setAndChangeSettings("backgroundColor",Object(g.a)({},r)),w(e.table,{name:"color_primary",value:t}).then((function(t){e.props.changePrimaryColor(t)}))}))}},{key:"changePrimaryColor",value:function(e){var t=this,r={id:this.props.primaryColor.id,name:"color_primary",value:e};N(this.table,r).then((function(e){t.props.primaryColor.id!==e&&(r.id=e,D(t.table,t.props.primaryColor.id)),t.setState({primaryColor:r}),t.props.changePrimaryColor(r)}))}},{key:"changeBackgroundToUrl",value:function(e){var t=this,r={name:"url",value:e};w(this.table,r).then((function(e){r.id=e,-1!==t.props.backgroundUrl.id&&D(t.table,t.props.backgroundUrl.id),t.setState({backgroundUrl:r}),-1!==t.props.backgroundColor.id&&(D(t.table,t.props.backgroundColor.id),t.setState({backgroundColor:{id:-1,value:""}}),t.props.setAndChangeSettings("backgroundColor",{id:-1,value:""})),t.props.setAndChangeSettings("backgroundUrl",r)}))}},{key:"changeBackgroundToColor",value:function(e){var t=this,r={name:"color",value:e};w(this.table,r).then((function(e){r.id=e,-1!==t.props.backgroundColor.id&&D(t.table,t.props.backgroundColor.id),t.setState({backgroundColor:r}),-1!==t.props.backgroundUrl.id&&(D(t.table,t.props.backgroundUrl.id),t.setState({backgroundUrl:{id:-1,value:""}}),t.props.setAndChangeSettings("backgroundUrl",{id:-1,value:""})),t.props.setAndChangeSettings("backgroundColor",r)}))}},{key:"render",value:function(){var e=this;return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("button",{type:"button",onClick:function(){return e.props.changeSettingsOpen()},className:"btn btn-sm m-1 position-absolute close-settings-btn",children:Object(n.jsx)("svg",{width:"1.5em",height:"1.5em",viewBox:"0 0 16 16",className:"bi bi-x svg-close-settings-btn",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:Object(n.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})})}),Object(n.jsxs)("div",{className:"mt-4",children:[Object(n.jsx)(f,{colors:this.colors,changeBackgroundToUrl:this.changeBackgroundToUrl}),Object(n.jsx)("h4",{className:"mt-1 ml-1",children:"\u0438\u043b\u0438 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0446\u0432\u0435\u0442: "}),Object(n.jsx)(m,{currentColor:this.props.backgroundColor,changeColorFunc:this.changeBackgroundToColor,colors:this.back_colors})]}),Object(n.jsx)("h4",{className:"mt-1 ml-1",children:"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u0446\u0432\u0435\u0442 \u043a\u043d\u043e\u043f\u043e\u043a: "}),Object(n.jsx)(m,{currentColor:this.props.primaryColor,changeColorFunc:this.changePrimaryColor,colors:this.primary_colors}),Object(n.jsx)("button",{type:"button",className:"btn btn-outline-primary text-button m-2",onClick:this.clearSettings,children:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0441\u0442\u0438\u043b\u0438"})]})}}]),r}(a.a.Component);function P(e){var t=Object(o.useState)(!1),r=Object(j.a)(t,2),a=r[0],i=r[1],c=Object(o.useState)(e.obj.title),s=Object(j.a)(c,2),d=s[0],u=s[1];function l(){e.obj.title=d,N(e.table,e.obj).then((function(){i(!1),C(e.table,e.obj.id).then((function(e){u(e.title)}))}))}return Object(o.useEffect)((function(){document.getElementById(e.id)&&document.getElementById(e.id).focus()})),Object(n.jsxs)("div",{className:"todos"===e.table?"todo-card card-border p-1 m-1 draggable":"dir-title p-1",id:"div/"+e.id,onDragStart:function(t){return function(e,t){e.dataTransfer.setData("obj",t.id)}(t,e.obj)},draggable:"todos"===e.table,children:[a?Object(n.jsx)("input",{id:e.id,type:"text",className:"form-control title-input",onBlur:function(){return i(!1),void l()},onKeyUp:function(e){return function(e){"Enter"===e.key&&l()}(e)},onChange:function(e){return u(e.target.value)},value:d}):Object(n.jsx)("div",{className:"title-span",id:"title-span"+e.id,onClick:function(){i(!0)},children:d}),Object(n.jsx)("div",{className:"spacer"}),Object(n.jsx)("button",{type:"button",onClick:function(){e.deleteObj(e.obj.id)},className:"delete-button btn",children:Object(n.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-x",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:Object(n.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})})})]})}var T=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).addNewTODO=n.addNewTODO.bind(Object(b.a)(n)),n.deleteDir=n.deleteDir.bind(Object(b.a)(n)),n.deleteToDo=n.deleteToDo.bind(Object(b.a)(n)),n.onDrop=n.onDrop.bind(Object(b.a)(n)),n}return Object(l.a)(r,[{key:"addNewTODO",value:function(e){var t=this;w("todos",{title:"New todo",describe:"new",data:(new Date).toISOString(),dir_id:e.dir.id,order:e.todos.length}).then((function(){return t.props.updateDirs()}))}},{key:"deleteDir",value:function(e){var t=this;D("dirs",e).then((function(){t.props.dirs.splice(t.props.dirs.findIndex((function(t){return t.dir.id===e})),1),t.promiseAllNewOrderSetInDb(t.props.dirs,"dirs")}))}},{key:"deleteToDo",value:function(e){var t=this;C("todos",e).then((function(r){var n=t.props.dirs.find((function(e){return e.dir.id===r.dir_id}));D("todos",e).then((function(){n.todos.splice(n.todos.findIndex((function(e){return e.id===r.id})),1),t.promiseAllNewOrderSetInDb(n.todos,"todos")}))}))}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"promiseAllNewOrderSetInDb",value:function(e,t){var r,n=this,o=0,a=[],i=Object(d.a)(e);try{for(i.s();!(r=i.n()).done;){var c=r.value;"todos"===t?(c.order=o,a.push(N(t,c))):(c.dir.order=o,a.push(N(t,c.dir))),o++}}catch(s){i.e(s)}finally{i.f()}Promise.all(a).then((function(){return n.props.updateDirs()}))}},{key:"setNewOrderInListOfToDos",value:function(e,t){t.todos=t.todos.sort((function(t,r){return t.order<r.order?-1:t.order>r.order?1:t.order===r.order?t.id===e.id?-1:1:0})),this.promiseAllNewOrderSetInDb(t.todos,"todos")}},{key:"onDrop",value:function(e,t){var r=this,n=+e.dataTransfer.getData("obj");C("todos",n).then((function(o){if(o.dir_id!==t.dir.id)o.dir_id=t.dir.id,o.order=t.todos.length,N("todos",o).then((function(){return r.updateDirs()}));else{var a=e.target.id;if(a){var i=+a.split(":")[1];i!==n&&C("todos",i).then((function(e){o.order=e.order+1,t.todos.find((function(e){return e.id===o.id})).order=e.order+1,r.setNewOrderInListOfToDos(o,t)}))}}}))}},{key:"render",value:function(){var e=this;return Object(n.jsx)(n.Fragment,{children:0!==this.props.dirs.length&&this.props.dirs.map((function(t){return Object(n.jsxs)("div",{className:"directory-card card-border p-2 m-2 droppable",onDrop:function(r){return e.onDrop(r,t)},onDragOver:function(t){return e.onDragOver(t)},children:[Object(n.jsx)(P,{table:"dirs",deleteObj:e.deleteDir,obj:t.dir,id:"dirs"+t.dir.id}),Object(n.jsx)("div",{className:"todos-scroll",children:t.todos.map((function(r){return Object(n.jsx)(P,{table:"todos",deleteObj:e.deleteToDo,obj:r,id:"todos/dir"+t.dir.id+"/todo:"+r.id},"todo"+r.id)}))}),Object(n.jsx)("button",{type:"button",className:"btn btn-outline-primary text-button m-1",onClick:function(){return e.addNewTODO(t)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]},t.dir.id)}))})}}]),r}(a.a.Component),U=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).state={isOpenSettings:!1,db:x,dirs:[],primaryColor:{id:-1,value:""},backgroundUrl:{id:-1,value:""},backgroundColor:{id:-1,value:""}},n.updateDirs=n.updateDirs.bind(Object(b.a)(n)),n.clear=n.clear.bind(Object(b.a)(n)),n.setAndChangeSettings=n.setAndChangeSettings.bind(Object(b.a)(n)),n.changeRootBySettings=n.changeRootBySettings.bind(Object(b.a)(n)),n.changePrimaryColor=n.changePrimaryColor.bind(Object(b.a)(n)),n}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this;this.updateDirs(),S("settings").then((function(t){var r,n=Object(d.a)(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;"url"===o.name&&e.setAndChangeSettings("backgroundUrl",o),"color"===o.name&&e.setAndChangeSettings("backgroundColor",o),"color_primary"===o.name&&e.changePrimaryColor(o)}}catch(a){n.e(a)}finally{n.f()}e.changeRootBySettings()}))}},{key:"setAndChangeSettings",value:function(e,t){var r=this;this.setState(Object(s.a)({},e,t),(function(){r.changeRootBySettings()}))}},{key:"changeRootBySettings",value:function(){var e=document.getElementById("root");e.style.backgroundImage="none",e.style.background="none",-1!==this.state.backgroundColor.id&&(e.style.background=this.state.backgroundColor.value),-1!==this.state.backgroundUrl.id&&(e.style.backgroundImage="url(".concat(this.state.backgroundUrl.value,")"))}},{key:"changePrimaryColor",value:function(e){var t=this;this.setState({primaryColor:e},(function(){return document.documentElement.style.setProperty("--primary-color",t.state.primaryColor.value)}))}},{key:"updateDirs",value:function(){var e=this;S("dirs").then((function(t){S("todos").then((function(r){var n,o=[],a=Object(d.a)(t);try{var i=function(){var e=n.value;o.push({dir:e,todos:r.filter((function(t){return t.dir_id===e.id})).sort((function(e,t){return e.order-t.order}))})};for(a.s();!(n=a.n()).done;)i()}catch(c){a.e(c)}finally{a.f()}o.sort((function(e,t){return e.order-t.order})),e.setState({dirs:o})}))}))}},{key:"addNewDir",value:function(){var e=this;w("dirs",{title:"New list",order:this.state.dirs.length}).then((function(){return e.updateDirs()}))}},{key:"clear",value:function(){var e=this;I("todos").then((function(){return I("dirs").then((function(){return e.updateDirs()}))}))}},{key:"setNewSettingsPanelPosition",value:function(){var e=this;this.setState((function(e){return{isOpenSettings:!e.isOpenSettings}}),(function(){e.state.isOpenSettings&&(document.getElementById("settings").style.animation="open-settings-panel 1s")}))}},{key:"changeSettingsOpenState",value:function(){var e=this;this.state.isOpenSettings?(document.getElementById("settings").style.animation="close-settings-panel 1s",setTimeout((function(){return e.setNewSettingsPanelPosition()}),1e3)):this.setNewSettingsPanelPosition()}},{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{className:"container-xl",children:[this.state.isOpenSettings&&Object(n.jsx)("div",{id:"settings",className:"settings-panel position-absolute",children:Object(n.jsx)(B,{primaryColor:this.state.primaryColor,backgroundColor:this.state.backgroundColor,backgroundUrl:this.state.backgroundUrl,changePrimaryColor:this.changePrimaryColor,setAndChangeSettings:this.setAndChangeSettings,changeSettingsOpen:function(){return e.changeSettingsOpenState()}})}),Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{className:"row",children:[Object(n.jsx)("button",{type:"button",className:"btn btn-outline-primary text-button m-2",onClick:function(){return e.addNewDir()},children:"\u041d\u043e\u0432\u044b\u0439 \u0441\u043f\u0438\u0441\u043e\u043a"}),Object(n.jsx)("button",{type:"button",className:"btn btn-outline-primary text-button m-2",onClick:function(){return e.clear()},children:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435"}),Object(n.jsx)("div",{className:"spacer"}),Object(n.jsx)("button",{type:"button",onClick:function(){return e.changeSettingsOpenState()},className:"btn btn-outline-primary text-button m-2",children:Object(n.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-toggles",children:Object(n.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",className:"bi bi-toggles",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:Object(n.jsx)("path",{d:"M4.5 9a3.5 3.5 0 1 0 0 7h7a3.5 3.5 0 1 0 0-7h-7zm7 6a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zm-7-14a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zm2.45 0A3.49 3.49 0 0 1 8 3.5 3.49 3.49 0 0 1 6.95 6h4.55a2.5 2.5 0 0 0 0-5H6.95zM4.5 0h7a3.5 3.5 0 1 1 0 7h-7a3.5 3.5 0 1 1 0-7z"})})})})]}),Object(n.jsx)("div",{className:"row directories-scroll",children:Object(n.jsx)(T,{updateDirs:this.updateDirs,dirs:this.state.dirs})})]})]})}}]),r}(a.a.Component),A=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,25)).then((function(t){var r=t.getCLS,n=t.getFID,o=t.getFCP,a=t.getLCP,i=t.getTTFB;r(e),n(e),o(e),a(e),i(e)}))},_=function(e){Object(h.a)(r,e);var t=Object(p.a)(r);function r(e){var n;return Object(u.a)(this,r),(n=t.call(this,e)).state={error:null,errorInfo:null},n}return Object(l.a)(r,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){return this.state.errorInfo?Object(n.jsxs)("div",{children:[Object(n.jsx)("h2",{children:"Something went wrong."}),Object(n.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),Object(n.jsx)("br",{}),this.state.errorInfo.componentStack]})]}):this.props.children}}]),r}(a.a.Component);c.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(_,{children:Object(n.jsx)(U,{})})}),document.getElementById("root")),A(console.log)}},[[24,1,2]]]);
//# sourceMappingURL=main.6e2ce657.chunk.js.map